
# **Object Detection using a Standard Algorithm**  

## **Aim**  
To perform object detection using a standard edge detection algorithm such as Sobel or Canny.  


---

## **Theory**  
Edge detection is a fundamental technique in image processing that identifies sharp intensity changes (gradients) in an image, highlighting object boundaries. Two of the most commonly used edge detection methods are Sobel and Canny.  

### **Sobel Edge Detection**  
The Sobel operator detects edges by calculating the gradient of image intensity. It applies convolution with two kernels to approximate the derivatives in horizontal (X) and vertical (Y) directions. It computes intensity variations along the X-axis and Y-axis separately.  

- **Uses two 3×3 Sobel kernels:**  

  **Sobel X Kernel (Detects vertical edges):**  
  \[
  G_x =
  \begin{bmatrix} 
  -1 & 0 & +1 \\ 
  -2 & 0 & +2 \\ 
  -1 & 0 & +1 
  \end{bmatrix}
  \]

  **Sobel Y Kernel (Detects horizontal edges):**  
  \[
  G_y =
  \begin{bmatrix} 
  -1 & -2 & -1 \\ 
  0 & 0 & 0 \\ 
  +1 & +2 & +1 
  \end{bmatrix}
  \]

- The final gradient magnitude is computed as:  
  \[
  G = \sqrt{G_x^2 + G_y^2}
  \]

### **Canny Edge Detection**  
The Canny edge detector is a more advanced method that identifies edges precisely while reducing noise. It involves a multi-step process:  

1. **Noise Reduction** – Applies Gaussian blur to smooth the image and remove noise.  
2. **Compute Gradients** – Uses the Sobel operator to find intensity gradients.  
3. **Non-Maximum Suppression (NMS)** – Keeps only the strongest edge pixels, suppressing weaker ones.  
4. **Double Thresholding** – Uses two thresholds to classify edges as strong, weak, or non-edges:  
   - **Strong edges (above high threshold)** are retained.  
   - **Weak edges (between thresholds)** are conditionally retained if connected to strong edges.  
   - **Non-edges (below low threshold)** are removed.  
5. **Edge Tracking by Hysteresis** – The final edge map is generated by connecting weak edges to strong ones.

---

## **Procedure**  

### **Step 1: Image Representation in Computer Vision**  
An image is a **matrix of pixel values**. Each pixel has intensity values corresponding to different channels:  
- **RGB (Red, Green, Blue)** – Standard color representation.  
- **Grayscale** – A single intensity channel (0-255).  

### **Step 2: Color Space Conversion**  
Changing the color space helps in feature extraction, object segmentation, and filtering. The code converts the original image into:  

- **Grayscale (`cv2.COLOR_BGR2GRAY`)** – Converts the image into a single channel of intensity values. Useful for edge detection and reducing computation complexity.  
- **HSV (`cv2.COLOR_BGR2HSV`)** – Stands for Hue, Saturation, and Value. Used in object detection where colors can be distinguished better than in RGB.  
- **YCrCb (`cv2.COLOR_BGR2YCrCb`)** – Separates luma (Y) from chroma (Cr, Cb). Used in compression techniques like JPEG.  
- **LAB (`cv2.COLOR_BGR2LAB`)** – Separates lightness (L) from color components (A and B). Useful for color-based segmentation and object detection.  

### **Step 3: Edge Detection Techniques**  
Edge detection helps in object identification by detecting areas with high-intensity gradients (sharp changes in pixel values).  

#### **(a) Sobel Edge Detection**  
Detects edges by applying a gradient operator in different directions:  
- **SobelX (`cv2.Sobel(img, cv2.CV_64F, 1, 0, ksize=5)`)** → Detects vertical edges.  
- **SobelY (`cv2.Sobel(img, cv2.CV_64F, 0, 1, ksize=5)`)** → Detects horizontal edges.  
- **SobelXY (`cv2.Sobel(img, cv2.CV_64F, 1, 1, ksize=5)`)** → Combines both.  

#### **(b) Canny Edge Detection**  
A multi-stage process that detects edges by:  
- **Smoothing the image** (reducing noise).  
- **Computing gradients** (detecting edge intensity).  
- **Applying non-maximum suppression** (removing weak edges).  
- **Using hysteresis thresholding** (connecting strong edges).  

The code applies different thresholds:  
- **Canny Edge (30,100):** Detects weak edges.  
- **Canny Edge (50,150):** Balanced edge detection.  
- **Canny Edge (70,200):** Detects strong edges but may lose details.  

---

## **Object Detection - Python Code**  

```python
import cv2
import matplotlib.pyplot as plt

# Load the image
img = cv2.imread("filename.jpg")  
print("Original Image Shape:", img.shape)

# Convert BGR to RGB for correct color display in Matplotlib
img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)

# Function to display images
def show_image(img, title="Image", cmap='gray'):
    plt.figure(figsize=(5, 5))
    plt.imshow(img, cmap=cmap)
    plt.title(title)
    plt.axis("off")
    plt.show()

# Display original image
show_image(img, "Original Image")

# Splitting the image into color channels
B, G, R = cv2.split(img)
show_image(B, "Blue Channel")
show_image(G, "Green Channel")
show_image(R, "Red Channel")

# Convert to Gray color space
grayImg = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
show_image(grayImg, "Grayscale Image")

# Convert to HSV color space
hsvImage = cv2.cvtColor(img, cv2.COLOR_BGR2HSV)
show_image(hsvImage, "HSV Image")

# Convert to YCrCb color space
YCRImage = cv2.cvtColor(img, cv2.COLOR_BGR2YCrCb)
show_image(YCRImage, "YCrCb Image")

# Convert to LAB color space
LabImage = cv2.cvtColor(img, cv2.COLOR_BGR2LAB)
show_image(LabImage, "LAB Image")

# Edge Detection
sobelXedge = cv2.Sobel(img, cv2.CV_64F, 1, 0, ksize=5)
sobelYedge = cv2.Sobel(img, cv2.CV_64F, 0, 1, ksize=5)
SobelXYedge = cv2.Sobel(img, cv2.CV_64F, 1, 1, ksize=5)

show_image(sobelXedge, "Sobel X-Order Edge")
show_image(sobelYedge, "Sobel Y-Order Edge")
show_image(SobelXYedge, "Sobel XY-Order Edge")

# Canny Edge Detection
edges = cv2.Canny(img, threshold1=30, threshold2=100)
edges1 = cv2.Canny(img, threshold1=50, threshold2=150)
edges2 = cv2.Canny(img, threshold1=70, threshold2=200)

show_image(edges, "Canny Edge - 30-100")
show_image(edges1, "Canny Edge - 50-150")
show_image(edges2, "Canny Edge - 70-200")
```

---

## **Result**  
The experiment successfully implemented object detection using **Sobel and Canny edge detection algorithms**. The Sobel operator detected vertical, horizontal, and combined edges, while the Canny detector applied different thresholds to identify object boundaries with high accuracy.